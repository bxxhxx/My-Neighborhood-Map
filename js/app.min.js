"use strict";var ViewModel=function(){var e=this;this.Star=function(e){this.fullName=ko.observable(e.fullName),this.category=ko.observable(e.category),this.address=e.address,this.chosen=!1,this.order=-1,this.show=ko.observable(!1),this.marker=new google.maps.Marker({map:null,animation:google.maps.Animation.DROP,position:null,icon:null}),this.categoryVisible=ko.observable(!1),this.multiple=e.multiple},this.walkOfFameList=ko.observableArray([]),this.query=ko.observable(""),this.currentCategory=ko.observable(""),this.currentStar=ko.observable(null),this.resizeMobileCalculator=function(){var e=window.innerHeight,r=window.innerWidth;return e>r&&701>r||r>e&&851>r?!0:!1};var r=$(window);r.resize(function(){e.isMobile(e.resizeMobileCalculator()),e.range=function(){return e.isMobile()===!0?5:15}(),e.walkOfFameList().forEach(function(r){var a;a=e.isMobile()===!0?"image/mobilstar.png":"image/smallstar.png",null!==r.marker&&(r.marker.setIcon(a),e.showRangeEvaluator(r))});var r=window.innerWidth,a=15,t=34.1,n=-118.332;if(e.isMobile()===!0)a=14;else{var o=100-r/1300*100,i=21604e-8*o;n+=i,1e3>r&&(a=14)}map.setCenter({lat:t,lng:n})}),this.isMobile=ko.observable(function(){return window.innerHeight>window.innerWidth&&window.innerWidth<701||window.innerHeight<window.innerWidth&&window.innerWidth<851?!0:!1}()),this.newOrder=0,this.topOrder=0,this.rangeStart=0,this.range=function(){return e.isMobile()===!0?5:15}(),this.infowindow=new google.maps.InfoWindow,this.category=ko.observableArray(["Live performance","Motion pictures","Radio","Recording","Television"]),completeStarDataModel.forEach(function(r){for(var a=r.fullName,t=function(e){return e.category.length>1?!0:!1},n=t(r),o=0;o<r.category.length;o++){var i=r.category[o],s=r.address[o],l={fullName:a,category:i,address:s,multiple:n};e.walkOfFameList.push(new e.Star(l))}}),this.showRangeEvaluator=function(r){if(r.order>=e.rangeStart&&r.order<e.rangeStart+e.range){r.show(!0);var a=function(r){""===e.currentCategory()&&r.multiple===!0?r.categoryVisible(!0):r.categoryVisible(!1)};a(r),e.starSetter(r)}else e.starClear(r)},this.starClear=function(e){null!==e.marker&&e.marker.setMap(null),e.show(!1)},this.search=function(r){e.currentCategory(""),e.newOrder=0,e.topOrder=0,e.rangeStart=0,e.walkOfFameList().forEach(function(a){r===!1||null===r?(a.order=-1,a.chosen=!1,e.starClear(a)):a.fullName().toLowerCase().indexOf(r.toLowerCase())>=0?(a.chosen=!0,a.order=e.newOrder,e.topOrder=e.newOrder,e.showRangeEvaluator(a),e.newOrder++):(a.order=-1,a.chosen=!1,e.starClear(a))})},e.query.subscribe(e.search),this.clearButton=function(){e.currentCategory(""),e.query(null),e.rangeStart=0,e.newOrder=0,e.topOrder=0,e.walkOfFameList().forEach(function(r){e.starClear(r)})},this.starSetter=function(r){if(null===r.marker.getPosition()){var a=r.address+",+Los+Angeles,+CA",t=setTimeout(function(){var e=document.getElementById("topSection");e.innerHTML='<p class="error">Error looking up locations! Try reloading.</p>'},8e3);$.getJSON("https://maps.googleapis.com/maps/api/geocode/json?address="+a+",+Los+Angeles,+CA",null,function(a,n){if(clearTimeout(t),"OK"==a.status){var o=a.results[0].geometry.location;if(r.marker.setPosition(o),r.marker.addListener("click",function(){e.chooseStar(r)}),r.show()===!0){var i;i=e.isMobile()===!0?"image/mobilstar.png":"image/smallstar.png",r.marker.setIcon(i),r.marker.setMap(map)}}else if("OVER_QUERY_LIMIT"===a.status)r.show()===!0&&e.starSetter(r);else{var s=document.getElementById("topSection");s.innerHTML='<p class="error">Error looking up locations! Try reloading.<br/>Error Message: '+a.status+"</p>"}})}else{var n;n=e.isMobile()===!0?"image/mobilstar.png":"image/smallstar.png",r.marker.setIcon(n),r.marker.setMap(map)}},this.chooseStar=function(r){var a;a=e.isMobile()===!0?"image/mobilstar.png":"image/smallstar.png",e.currentStar()&&(e.currentStar().marker.setAnimation(null),e.currentStar().marker.setIcon(a)),e.currentStar(r);var t;t=e.isMobile()===!0?"image/mobilstarActivated.png":"image/smallstarActivated.png",r.marker.setIcon(t),e.infoActivate(e.currentStar())},this.toggleBounce=function(e){null!==e.marker.getAnimation()?e.marker.setAnimation(null):e.marker.setAnimation(google.maps.Animation.BOUNCE)},this.infoActivate=function(r){var a="",t="https://en.wikipedia.org/w/api.php",n=r.fullName(),o=r.address,i=setTimeout(function(){console.log("timeout");var a='<div class="infoWindow"><p>'+n+"</p><p>"+o+'</p><p class="error">Wikipedia link unavailable - please try again later!</p></div>';e.infowindow.setContent(a),e.infowindow.open(map,r.marker),e.toggleBounce(r)},8e3);$.ajax({url:t,data:{action:"opensearch",search:n,format:"json",limit:1,namespace:0},dataType:"jsonp"}).done(function(t){a=t[3][0];var s='<div class="infoWindow"><p>'+n+"</p><p>"+o+'</p><p><a target="_blank" href="'+a+'">Read more at Wikipedia</a></p></div>';e.infowindow.setContent(s),e.infowindow.open(map,r.marker),e.toggleBounce(r),clearTimeout(i)}).fail(function(){var a='<div class="infoWindow"><p>'+n+"</p><p>"+o+'</p><p class="error">Wikipedia link unavailable - please try again later!</p></div>';e.infowindow.setContent(a),e.infowindow.open(map,r.marker),e.toggleBounce(r),clearTimeout(i)})},this.categorySelector=function(r){e.clearButton(),e.currentCategory(r),e.walkOfFameList().forEach(function(a){r===a.category()?(a.chosen=!0,a.order=e.newOrder,e.topOrder=e.newOrder,e.showRangeEvaluator(a),e.newOrder++):(a.order=-1,a.chosen=!1,e.starClear(a))})},this.nextRange=function(){var r=e.rangeStart+e.range;r<e.topOrder&&(e.rangeStart=r,e.walkOfFameList().forEach(function(r){e.showRangeEvaluator(r)}))},this.previousRange=function(){var r=e.rangeStart-e.range;r>=0&&(e.rangeStart=r,e.walkOfFameList().forEach(function(r){e.showRangeEvaluator(r)}))},e.query("Charlie Chaplin")};